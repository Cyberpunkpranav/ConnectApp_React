"use strict";(self.webpackChunkconnect_app=self.webpackChunkconnect_app||[]).push([[609],{9689:function(e,t,n){n.r(t);var o=n(4165),s=n(5861),i=n(3433),a=n(9439),c=n(9867),r=n(6626),l=n(7992),u=n.n(l),d=n(1230),h=(n(5144),n(9045),n(465)),m=n.n(h),p=n(606),g=n(2834);t.default=function(e){var t=(0,c.useContext)(r.Jx),n=(0,c.useState)(""),l=(0,a.Z)(n,2),h=l[0],f=l[1],x=(0,c.useState)(),b=(0,a.Z)(x,2),j=(b[0],b[1],(0,c.useRef)(null)),v=((0,c.useRef)(null),(0,c.useState)("none")),w=(0,a.Z)(v,2),y=w[0],N=w[1],k=(0,c.useState)("none"),C=(0,a.Z)(k,2),Z=C[0],S=C[1],I=(0,c.useState)([]),z=(0,a.Z)(I,2),F=z[0],H=z[1],P=(0,c.useState)(0),R=(0,a.Z)(P,2),_=R[0],A=R[1],D=(0,c.useState)(),E=(0,a.Z)(D,2),U=E[0],W=E[1],B=(0,c.useState)("user"),L=(0,a.Z)(B,2),T=L[0],J=L[1],M=(0,c.useState)(!1),O=(0,a.Z)(M,2),q=O[0],G=O[1],K=window.innerWidth,Q=window.innerHeight,V={width:K,height:Q,facingMode:T},X=(0,c.useCallback)((function(){var e=j.current.getScreenshot();F.length>0?(H(e),u().Notify.info("Photo Captured"),Y()):(H((function(t){return[].concat((0,i.Z)(t),[e])})),u().Notify.info("Photo Captured"),Y())}),[j]),Y=function(){"block"==y&&N("none"),"none"==y&&N("block")},$=function(){"none"==Z&&S(""),""==Z&&S("none")},ee=(0,c.useState)(null),te=(0,a.Z)(ee,2),ne=te[0],oe=te[1],se=(0,c.useState)({unit:"%",x:25,y:25,width:100,height:100}),ie=(0,a.Z)(se,2),ae=ie[0],ce=ie[1],re=(0,c.useState)(null),le=(0,a.Z)(re,2),ue=le[0],de=le[1],he=(0,c.useRef)(null);(0,c.useEffect)((function(){ne&&function(e){var t=new Image;t.src=e,t.onload=function(){he.current=t}}(ne)}),[ne]);var me=function(e,t){var n=document.createElement("canvas"),o=e.naturalWidth/e.width,s=e.naturalHeight/e.height;return n.width=t.width,n.height=t.height,n.getContext("2d").drawImage(e,t.x*o,t.y*s,t.width*o,t.height*s,0,0,t.width,t.height),n.toDataURL("image/jpeg")},pe=function(){var e=(0,s.Z)((0,o.Z)().mark((function e(t){var n;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(he.current&&t.width&&t.height)){e.next=8;break}return $(),de(),e.next=5,me(he.current,t);case 5:n=e.sent,W(n),f("block");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ge=localStorage.getItem("appointmentid");function fe(){window.close()}function xe(e){for(var t=e.split(","),n=t[0].match(/:(.*?);/)[1],o=atob(t[1]),s=new ArrayBuffer(o.length),i=new Uint8Array(s),a=0;a<o.length;a++)i[a]=o.charCodeAt(a);var c=new Blob([i],{type:n});return new File([c],"like.jpeg",{type:n})}var be=function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){var n,s;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=xe(U),(s=new FormData).append("image",n,"prescription.jpeg"),s.append("appointment_id",ge),G(!0),p.Z.post("".concat(t,"/save/document"),s,{headers:{"Content-Type":"multipart/form-data"}}).then((function(e){console.log("File uploaded successfully:",e.data),1==e.data.status&&(u().Notify.success("Prescription Uploaded Successfully"),setTimeout(fe,2e3),G(!1))})).catch((function(e){console.error("Error uploading file:",e),G(!1)}));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return console.log(Z),(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)("div",{className:"p-0 m-0 position-absolute top-0 start-0 ebd-0 mx-auto",style:{zIndex:"10"},children:[(0,g.jsx)("div",{className:"d-".concat(""==Z?"none":"block"," col-12 p-0 m-0"),children:(0,g.jsx)(m(),{audio:!1,ref:j,screenshotFormat:"image/jpeg",mirrored:!1,videoConstraints:V})}),(0,g.jsx)("div",{className:"col-12 bg-charcoal d-".concat("block"==h?"none":"block"),children:(0,g.jsxs)("div",{className:"row p-0 m-0 justify-content-between align-items-center position-relative",children:[(0,g.jsxs)("div",{className:"col-3",children:[(0,g.jsx)("button",{className:"border-0 justify-content-start cameraroll button button-pearl p-0 m-0 ",onClick:function(){Y()},children:"none"==y?(0,g.jsx)("img",{src:"/images/gallery.png",className:"img-fluid bg-charcoal75 px-2 py-1 rounded-top mb-1",style:{width:"2rem"}}):(0,g.jsx)("img",{src:"/images/bottom.png",className:"img-fluid bg-seashell px-2 py-1 rounded-top mb-1"})}),(0,g.jsx)("div",{className:"container position-absolute cameraroll scroll bg-charcoal25 ms-2 d-".concat(y),style:{flexDirection:"horizontal",minHeight:"fit-content",zIndex:"10",top:"-10rem"},children:F?F.map((function(e,t){return(0,g.jsx)("img",{src:e,className:"img-fluid",onClick:function(){$(),A(t),oe(F[_])},style:{width:"5rem"}})})):""})]}),(0,g.jsx)("div",{className:"col-6 align-items-center d-flex justify-content-center",children:(0,g.jsx)("img",{className:"img-fluid bg-lightyellow rounded-2",onClick:function(){X()},style:{width:"4rem"},src:"/images/camera_click.png"})}),(0,g.jsx)("div",{className:"col-3 d-flex justify-content-center",children:(0,g.jsx)("button",{className:"button button-pearl border-0 cameraroll p-0 m-0",onClick:function(){J("user"==T?"environment":"user")},children:(0,g.jsx)("img",{src:"/images/flip.png",className:"img-fluid bg-charcoal75 px-2 py-1 rounded-top mb-1",style:{width:"1.8rem"}})})})]})}),j.current?(0,g.jsxs)("div",{className:"d-".concat(Z," position-absolute p-0 m-0 top-0 bg-pearl shadow-sm"),style:{zIndex:"15",height:Q,width:K},children:[(0,g.jsx)("button",{className:"position-absolute end-0 bg-seashell50 p-2 mt-3 btn-close",style:{zIndex:"18"},onClick:function(){$()}}),(0,g.jsx)("div",{className:"p-0 m-0 position-absolute start-0 end-0 mx-auto",children:(0,g.jsx)(d.cO,{crop:ae,onChange:function(e){return ce(e)},onComplete:function(e){return de(e)},children:(0,g.jsx)("img",{src:ne,className:"img-fluid",style:{width:"".concat(j.current.video.videoWidth,"px"),height:"".concat(j.current.video.videoHeight,"px")}})})})]}):(0,g.jsx)(g.Fragment,{})]}),ue&&(0,g.jsx)("div",{className:"position-absolute top-0 mt-4 ms-2",style:{zIndex:"15"},children:(0,g.jsx)("button",{className:"button button-charcoal text-light border border-light",onClick:function(){return pe(ue)},children:"Save"})}),U?(0,g.jsxs)("div",{className:"position-absolute top-0 start-0 mx-auto end-0 bg-charcoal d-".concat(h),style:{height:Q,width:K,zIndex:"20"},children:[(0,g.jsx)("button",{className:"btn-close position-absolute bg-seashell50 mt-3 me-3 p-2 top-0 end-0",onClick:function(){f("none")}}),(0,g.jsx)("div",{className:"position-relative d-flex mt-5 justify-content-center",children:(0,g.jsx)("img",{src:U,className:"img-fluid",style:{width:ae.width,height:ae.height}})}),q?(0,g.jsx)("div",{className:"col-6 py-2 pb-2 m-auto text-center",children:(0,g.jsx)("div",{class:"spinner-border",role:"status",children:(0,g.jsx)("span",{class:"visually-hidden",children:"Loading..."})})}):(0,g.jsx)("button",{className:" mx-auto d-flex justify-content-center button button-pearl",onClick:function(e){be(e)},children:"Save Prescription"})]}):(0,g.jsx)(g.Fragment,{})]})}},9045:function(){}}]);
//# sourceMappingURL=609.b568a087.chunk.js.map